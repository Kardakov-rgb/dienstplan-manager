<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" fx:controller="de.dienstplan.controller.DienstplanerstellungController">
   <top>
      <VBox spacing="15.0">
         <padding>
            <Insets bottom="15.0" left="20.0" right="20.0" top="20.0" />
         </padding>
         
         <!-- Ãœberschrift -->
         <Label style="-fx-font-size: 24px; -fx-font-weight: bold;" text="Dienstplan-Erstellung" />
         
         <!-- Konfigurationsbereich -->
         <HBox alignment="CENTER_LEFT" spacing="20.0">
            <VBox spacing="5.0">
               <Label text="Monat:" />
               <ComboBox fx:id="monatComboBox" prefWidth="120.0" />
            </VBox>
            
            <VBox spacing="5.0">
               <Label text="Jahr:" />
               <ComboBox fx:id="jahrComboBox" prefWidth="80.0" />
            </VBox>
            
            <VBox spacing="5.0">
               <Label text="Name:" />
               <TextField fx:id="dienstplanNameField" prefWidth="200.0" promptText="z.B. Dienstplan Dezember 2024" />
            </VBox>
            
            <Region HBox.hgrow="ALWAYS" />
            
            <VBox spacing="10.0">
               <Button fx:id="generiereButton" onAction="#onDienstplanGenerieren" 
                       style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold;" 
                       text="ðŸš€ Dienstplan generieren" />
               <Button fx:id="speichernButton" disable="true" onAction="#onDienstplanSpeichern" 
                       style="-fx-background-color: #2196F3; -fx-text-fill: white;" 
                       text="ðŸ’¾ Speichern" />
            </VBox>
         </HBox>
         
         <!-- Status und Warnungen -->
         <HBox alignment="CENTER_LEFT" spacing="15.0">
            <Label fx:id="statusLabel" text="Bereit fÃ¼r Generierung" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="statistikLabel" text="" />
         </HBox>
         
         <!-- Warnungen Panel (ausblendbar) -->
         <VBox fx:id="warnungenPanel" managed="false" spacing="5.0" visible="false">
            <Label style="-fx-font-weight: bold; -fx-text-fill: #f44336;" text="âš ï¸ Warnungen:" />
            <ListView fx:id="warnungenList" prefHeight="100.0" />
         </VBox>
      </VBox>
   </top>
   
   <center>
      <SplitPane dividerPositions="0.75" orientation="HORIZONTAL">
         
         <!-- Kalender-Ansicht -->
         <VBox spacing="10.0">
            <padding>
               <Insets bottom="20.0" left="20.0" right="10.0" top="10.0" />
            </padding>
            
            <!-- Kalender Header -->
            <HBox alignment="CENTER" spacing="20.0">
               <Button fx:id="vorherigerMonatButton" onAction="#onVorherigerMonat" text="â—€" />
               <Label fx:id="kalenderTitelLabel" style="-fx-font-size: 18px; -fx-font-weight: bold;" text="Dezember 2024" />
               <Button fx:id="naechsterMonatButton" onAction="#onNaechsterMonat" text="â–¶" />
               <Region HBox.hgrow="ALWAYS" />
               <ComboBox fx:id="ansichtComboBox" onAction="#onAnsichtWechsel" prefWidth="150.0" />
            </HBox>
            
            <!-- Legende -->
            <HBox alignment="CENTER_LEFT" spacing="20.0">
               <Label style="-fx-background-color: #E3F2FD; -fx-padding: 5px; -fx-border-color: #2196F3;" text="24h" />
               <Label style="-fx-background-color: #E8F5E8; -fx-padding: 5px; -fx-border-color: #4CAF50;" text="Visten" />
               <Label style="-fx-background-color: #FFF3E0; -fx-padding: 5px; -fx-border-color: #FF9800;" text="SpÃ¤t" />
               <Label style="-fx-background-color: #FFEBEE; -fx-padding: 5px; -fx-border-color: #f44336;" text="Leer" />
               <Label style="-fx-background-color: #F3E5F5; -fx-padding: 5px; -fx-border-color: #9C27B0;" text="Abwesend" />
            </HBox>
            
            <Separator />
            
            <!-- Kalender Grid -->
            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS">
               <GridPane fx:id="kalenderGrid" hgap="2.0" vgap="2.0">
                  <padding>
                     <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                  </padding>
               </GridPane>
            </ScrollPane>
         </VBox>
         
         <!-- Details/Bearbeitung Panel -->
         <VBox spacing="15.0">
            <padding>
               <Insets bottom="20.0" left="10.0" right="20.0" top="10.0" />
            </padding>
            
            <Label fx:id="detailsTitel" style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Dienst Details" />
            
            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS">
               <VBox spacing="15.0">
                  <padding>
                     <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                  </padding>
                  
                  <!-- AusgewÃ¤hlter Dienst -->
                  <VBox fx:id="dienstDetailsPanel" managed="false" spacing="10.0" visible="false">
                     <Label style="-fx-font-weight: bold;" text="AusgewÃ¤hlter Dienst" />
                     
                     <GridPane hgap="10.0" vgap="8.0">
                        <columnConstraints>
                           <ColumnConstraints minWidth="80.0" />
                           <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>
                        
                        <Label text="Datum:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <Label fx:id="dienstDatumLabel" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                        
                        <Label text="Art:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <Label fx:id="dienstArtLabel" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        
                        <Label text="Person:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                        <ComboBox fx:id="dienstPersonComboBox" onAction="#onPersonZuweisungChange" 
                                  promptText="Person auswÃ¤hlen..." GridPane.columnIndex="1" GridPane.rowIndex="2" />
                        
                        <Label text="Status:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                        <ComboBox fx:id="dienstStatusComboBox" onAction="#onStatusChange" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                        
                        <Label text="Bemerkung:" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                        <TextArea fx:id="dienstBemerkungArea" prefRowCount="3" GridPane.columnIndex="1" GridPane.rowIndex="4" />
                     </GridPane>
                     
                     <HBox spacing="10.0">
                        <Button fx:id="dienstSpeichernButton" onAction="#onDienstSpeichern" 
                                style="-fx-background-color: #2196F3; -fx-text-fill: white;" text="Speichern" />
                        <Button fx:id="dienstZuruecksetzenButton" onAction="#onDienstZuruecksetzen" text="ZurÃ¼cksetzen" />
                     </HBox>
                  </VBox>
                  
                  <Separator fx:id="detailsSeparator" managed="false" visible="false" />
                  
                  <!-- Statistiken -->
                  <VBox spacing="10.0">
                     <Label style="-fx-font-weight: bold;" text="Dienstplan-Statistiken" />
                     
                     <GridPane hgap="15.0" vgap="8.0">
                        <columnConstraints>
                           <ColumnConstraints minWidth="120.0" />
                           <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>
                        
                        <Label text="Zuweisungsgrad:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <ProgressBar fx:id="zuweisungsgradBar" prefWidth="150.0" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                        
                        <Label text="Gesamt Dienste:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <Label fx:id="gesamtDiensteLabel" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        
                        <Label text="Zugewiesen:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                        <Label fx:id="zugewiesenLabel" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                        
                        <Label text="Offen:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                        <Label fx:id="offenLabel" style="-fx-text-fill: #f44336;" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                     </GridPane>
                  </VBox>
                  
                  <Separator />
                  
                  <!-- Dienste pro Person -->
                  <VBox spacing="10.0">
                     <Label style="-fx-font-weight: bold;" text="Dienste pro Person" />
                     <TableView fx:id="personStatistikTabelle" prefHeight="200.0">
                        <columns>
                           <TableColumn fx:id="personNameColumn" prefWidth="120.0" text="Person" />
                           <TableColumn fx:id="personAnzahlColumn" prefWidth="60.0" text="Anzahl" />
                           <TableColumn fx:id="person24hColumn" prefWidth="40.0" text="24h" />
                           <TableColumn fx:id="personVistenColumn" prefWidth="40.0" text="V" />
                           <TableColumn fx:id="personSpaetColumn" prefWidth="40.0" text="S" />
                        </columns>
                        <columnResizePolicy>
                           <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                     </TableView>
                  </VBox>
                  
                  <Separator />
                  
                  <!-- Schnellaktionen -->
                  <VBox spacing="10.0">
                     <Label style="-fx-font-weight: bold;" text="Schnellaktionen" />
                     
                     <VBox spacing="5.0">
                        <Button fx:id="alleBestaetigenButton" onAction="#onAlleDiensteBestaetigen" 
                                prefWidth="200.0" text="âœ… Alle Dienste bestÃ¤tigen" />
                        <Button fx:id="offeneAnzeigenButton" onAction="#onOffeneDiensteAnzeigen" 
                                prefWidth="200.0" text="ðŸ” Offene Dienste anzeigen" />
                        <Button fx:id="konflikteFindenButton" onAction="#onKonflikteAnzeigen" 
                                prefWidth="200.0" text="âš ï¸ Konflikte suchen" />
                        <Button fx:id="dienstplanLeeren" onAction="#onDienstplanLeeren" 
                                prefWidth="200.0" style="-fx-background-color: #f44336; -fx-text-fill: white;" 
                                text="ðŸ—‘ï¸ Dienstplan leeren" />
                     </VBox>
                  </VBox>
               </VBox>
            </ScrollPane>
         </VBox>
      </SplitPane>
   </center>
   
   <bottom>
      <HBox alignment="CENTER_LEFT" spacing="15.0">
         <padding>
            <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
         </padding>
         
         <Label fx:id="bottomStatusLabel" text="Kein Dienstplan geladen" />
         <Region HBox.hgrow="ALWAYS" />
         <Label fx:id="letzteAktualisierungLabel" text="" />
      </HBox>
   </bottom>
</BorderPane>