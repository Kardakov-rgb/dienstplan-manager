<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" fx:controller="de.dienstplan.controller.DienstplanerstellungController">
   <top>
      <VBox spacing="8.0">
         <padding>
            <Insets bottom="8.0" left="15.0" right="15.0" top="10.0" />
         </padding>

         <!-- Konfigurationsbereich -->
         <HBox alignment="CENTER_LEFT" spacing="15.0">
            <VBox spacing="3.0">
               <Label text="Monat:" styleClass="text-muted" style="-fx-font-size: 11px;" />
               <ComboBox fx:id="monatComboBox" prefWidth="120.0" />
            </VBox>

            <VBox spacing="3.0">
               <Label text="Jahr:" styleClass="text-muted" style="-fx-font-size: 11px;" />
               <ComboBox fx:id="jahrComboBox" prefWidth="80.0" />
            </VBox>

            <!-- Excel-Buttons (dezenter) -->
            <VBox spacing="3.0">
               <Label text="Excel:" styleClass="text-muted" style="-fx-font-size: 11px;" />
               <HBox spacing="4.0">
                  <Button fx:id="excelVorlageButton" onAction="#onExcelVorlageHerunterladen"
                          styleClass="btn-outline-secondary" style="-fx-font-size: 11px; -fx-padding: 3 8;"
                          text="Vorlage" />
                  <Button fx:id="excelImportButton" onAction="#onExcelWuenscheImportieren"
                          styleClass="btn-outline-secondary" style="-fx-font-size: 11px; -fx-padding: 3 8;"
                          text="Import" />
               </HBox>
            </VBox>

            <Region HBox.hgrow="ALWAYS" />

            <!-- Hauptaktionen -->
            <VBox spacing="5.0" alignment="CENTER_RIGHT">
               <Button fx:id="generiereButton" onAction="#onDienstplanGenerieren"
                       styleClass="btn-primary" style="-fx-padding: 8 18;"
                       text="Dienstplan generieren" />
               <HBox spacing="5.0">
                  <Button fx:id="speichernButton" disable="true" onAction="#onDienstplanSpeichern"
                          styleClass="btn-secondary"
                          text="Speichern" />
                  <Button fx:id="exportButton" disable="true" onAction="#onDienstplanExportieren"
                          styleClass="btn-accent"
                          text="Export" />
               </HBox>
            </VBox>
         </HBox>
         
         <!-- Warnungen Panel (ausblendbar) -->
         <VBox fx:id="warnungenPanel" managed="false" spacing="5.0" visible="false">
            <Label style="-fx-font-weight: bold; -fx-text-fill: #f44336;" text="âš ï¸ Warnungen:" />
            <ListView fx:id="warnungenList" prefHeight="100.0" />
         </VBox>
      </VBox>
   </top>
   
   <center>
      <SplitPane dividerPositions="0.78" orientation="HORIZONTAL">

         <!-- Kalender-Ansicht -->
         <VBox spacing="6.0">
            <padding>
               <Insets bottom="10.0" left="10.0" right="5.0" top="5.0" />
            </padding>

            <!-- Kalender Header -->
            <HBox alignment="CENTER" spacing="15.0">
               <Button fx:id="vorherigerMonatButton" onAction="#onVorherigerMonat" text="â—€" />
               <Label fx:id="kalenderTitelLabel" style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Dezember 2024" />
               <Button fx:id="naechsterMonatButton" onAction="#onNaechsterMonat" text="â–¶" />
               <Region HBox.hgrow="ALWAYS" />
               <ComboBox fx:id="ansichtComboBox" onAction="#onAnsichtWechsel" prefWidth="150.0" />
            </HBox>

            <!-- Wunsch-Info (falls WÃ¼nsche importiert) -->
            <HBox fx:id="wunschInfoPanel" alignment="CENTER_LEFT" managed="false" spacing="10.0" visible="false">
               <Label fx:id="wunschInfoLabel" style="-fx-text-fill: #795548;" text="Keine WÃ¼nsche importiert" />
            </HBox>
            
            <Separator />
            
            <!-- Kalender Grid -->
            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS">
               <GridPane fx:id="kalenderGrid" hgap="2.0" vgap="2.0">
                  <padding>
                     <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                  </padding>
               </GridPane>
            </ScrollPane>
         </VBox>
         
         <!-- Details/Bearbeitung Panel -->
         <VBox spacing="8.0">
            <padding>
               <Insets bottom="10.0" left="5.0" right="10.0" top="5.0" />
            </padding>

            <Label fx:id="detailsTitel" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: black;" text="Dienst Details" />

            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS">
               <VBox spacing="10.0">
                  <padding>
                     <Insets bottom="5.0" left="5.0" right="5.0" top="5.0" />
                  </padding>
                  
                  <!-- AusgewÃ¤hlter Dienst -->
                  <VBox fx:id="dienstDetailsPanel" managed="false" spacing="10.0" visible="false">
                     <Label style="-fx-font-weight: bold; -fx-text-fill: black;" text="AusgewÃ¤hlter Dienst" />

                     <GridPane hgap="10.0" vgap="8.0">
                        <columnConstraints>
                           <ColumnConstraints minWidth="80.0" />
                           <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>

                        <Label text="Datum:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <Label fx:id="dienstDatumLabel" style="-fx-text-fill: black;" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                        <Label text="Art:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <Label fx:id="dienstArtLabel" style="-fx-text-fill: black;" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                        <Label text="Person:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                        <ComboBox fx:id="dienstPersonComboBox" onAction="#onPersonZuweisungChange"
                                  promptText="Person auswÃ¤hlen..." GridPane.columnIndex="1" GridPane.rowIndex="2" />

                        <Label text="Status:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                        <ComboBox fx:id="dienstStatusComboBox" onAction="#onStatusChange" GridPane.columnIndex="1" GridPane.rowIndex="3" />

                        <Label text="Bemerkung:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                        <TextArea fx:id="dienstBemerkungArea" prefRowCount="3" GridPane.columnIndex="1" GridPane.rowIndex="4" />
                     </GridPane>
                     
                     <HBox spacing="10.0">
                        <Button fx:id="dienstSpeichernButton" onAction="#onDienstSpeichern"
                                styleClass="btn-secondary" text="Speichern" />
                        <Button fx:id="dienstZuruecksetzenButton" onAction="#onDienstZuruecksetzen"
                                styleClass="btn-outline-secondary" text="ZurÃ¼cksetzen" />
                     </HBox>
                  </VBox>
                  
                  <Separator fx:id="detailsSeparator" managed="false" visible="false" />
                  
                  <!-- Statistiken -->
                  <VBox spacing="10.0">
                     <Label style="-fx-font-weight: bold; -fx-text-fill: black;" text="Dienstplan-Statistiken" />

                     <GridPane hgap="15.0" vgap="8.0">
                        <columnConstraints>
                           <ColumnConstraints minWidth="120.0" />
                           <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>

                        <Label text="Zuweisungsgrad:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <ProgressBar fx:id="zuweisungsgradBar" prefWidth="150.0" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                        <Label text="Gesamt Dienste:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <Label fx:id="gesamtDiensteLabel" style="-fx-text-fill: black;" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                        <Label text="Zugewiesen:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                        <Label fx:id="zugewiesenLabel" style="-fx-text-fill: black;" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                        <Label text="Offen:" style="-fx-text-fill: black;" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                        <Label fx:id="offenLabel" style="-fx-text-fill: #f44336;" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                     </GridPane>
                  </VBox>
                  
                  <Separator />
                  
                  <!-- Dienste pro Person -->
                  <VBox spacing="10.0">
                     <Label style="-fx-font-weight: bold;" text="Dienste pro Person" />
                     <TableView fx:id="personStatistikTabelle" prefHeight="150.0">
                        <columns>
                           <TableColumn fx:id="personNameColumn" prefWidth="120.0" text="Person" />
                           <TableColumn fx:id="personAnzahlColumn" prefWidth="60.0" text="Anzahl" />
                           <TableColumn fx:id="person24hColumn" prefWidth="40.0" text="24h" />
                           <TableColumn fx:id="personVistenColumn" prefWidth="40.0" text="V" />
                           <TableColumn fx:id="personDaVinciColumn" prefWidth="40.0" text="DV" />
                        </columns>
                        <columnResizePolicy>
                           <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                     </TableView>
                  </VBox>

                  <Separator />

                  <!-- WunscherfÃ¼llung (nur sichtbar wenn WÃ¼nsche vorhanden) -->
                  <VBox fx:id="wunscherfuellungPanel" managed="false" spacing="10.0" visible="false">
                     <Label style="-fx-font-weight: bold;" text="Wunscherfuellung" />
                     <GridPane hgap="15.0" vgap="8.0">
                        <columnConstraints>
                           <ColumnConstraints minWidth="120.0" />
                           <ColumnConstraints hgrow="ALWAYS" />
                        </columnConstraints>

                        <Label text="Freiwuensche:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <Label fx:id="freiwunschStatLabel" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                        <Label text="Dienstwuensche:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <Label fx:id="dienstwunschStatLabel" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                        <Label text="Gesamt-Quote:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                        <Label fx:id="gesamtQuoteLabel" style="-fx-font-weight: bold;" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                     </GridPane>
                     <Button fx:id="wunschDetailsButton" onAction="#onWunschDetailsAnzeigen"
                             prefWidth="200.0" text="Details anzeigen" />
                  </VBox>

                  <Separator visible="false" managed="false" />

                  <!-- Schnellaktionen - AUSGEBLENDET -->
                  <VBox spacing="10.0" visible="false" managed="false">
                     <Label style="-fx-font-weight: bold;" text="Schnellaktionen" />

                     <VBox spacing="5.0">
                        <Button fx:id="alleBestaetigenButton" onAction="#onAlleDiensteBestaetigen"
                                prefWidth="200.0" text="âœ… Alle Dienste bestÃ¤tigen" />
                        <Button fx:id="offeneAnzeigenButton" onAction="#onOffeneDiensteAnzeigen"
                                prefWidth="200.0" text="ðŸ” Offene Dienste anzeigen" />
                        <Button fx:id="konflikteFindenButton" onAction="#onKonflikteAnzeigen"
                                prefWidth="200.0" text="âš ï¸ Konflikte suchen" />
                        <Button fx:id="dienstplanLeeren" onAction="#onDienstplanLeeren"
                                prefWidth="200.0" style="-fx-background-color: #f44336; -fx-text-fill: white;"
                                text="ðŸ—‘ï¸ Dienstplan leeren" />
                     </VBox>
                  </VBox>
               </VBox>
            </ScrollPane>
         </VBox>
      </SplitPane>
   </center>
   
   <bottom>
      <HBox alignment="CENTER_LEFT" spacing="15.0">
         <padding>
            <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
         </padding>
         
         <Label fx:id="bottomStatusLabel" text="Kein Dienstplan geladen" />
         <Region HBox.hgrow="ALWAYS" />
         <Label fx:id="letzteAktualisierungLabel" text="" />
      </HBox>
   </bottom>
</BorderPane>